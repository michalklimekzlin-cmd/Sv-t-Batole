<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <style>
  html,body{margin:0; background:#000; color:#e8fff6; font-family:system-ui,-apple-system,Segoe UI,Roboto; height:100%}
  /* HUD */
  #hud{position:sticky;top:0;z-index:5;display:flex;gap:.8rem;align-items:center;
       padding:.75rem 1rem;background:rgba(0,0,0,.6);backdrop-filter:saturate(120%) blur(6px)}
  #vafiDot{width:.9rem;height:.9rem;border-radius:50%;display:inline-block;box-shadow:0 0 .6rem currentColor;
           animation:vafiPulse 2.2s ease-in-out infinite}
  @keyframes vafiPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}
  #vafiStatus{position:fixed;left:1rem;bottom:1rem;opacity:.8;font-size:.9rem;pointer-events:none}
  .vafi-whisper{position:fixed;right:1.2rem;bottom:4.6rem;opacity:0;transform:translateY(8px) scale(.9);
                transition:all .45s ease;font-size:1.4rem;color:rgba(180,255,230,.92);text-shadow:0 0 .6rem currentColor;pointer-events:none}
  .vafi-whisper.on{opacity:1;transform:translateY(0) scale(1)}
  /* Plátna přes celou obrazovku, jedno nad druhým */
  canvas{position:absolute;left:0;top:0;width:100vw;height:100vh;display:block}
  #canvas{z-index:0} #canvasVafi{z-index:1; /* pokud bude brát gesta, dočasně: */ pointer-events:none;}
</style>
  <title>Vivere atque frui</title>
  <link rel="stylesheet" href="./styles.css?v=2" />
</head>
<body>

  <!-- HUD (musí být nad plátny) -->
  <header id="hud">
    <span id="vafiDot" aria-hidden="true"></span>
    <span class="vaf-label">Vivere atque frui</span>
    <span> ✶ <span id="moodPct">--</span>% </span>
    <span> ⚡ <span id="energyVal">--</span> </span>
  </header>

  <!-- Plátna -->
  <canvas id="canvas"></canvas>
  <canvas id="canvasVafi"></canvas>

  <!-- Stavová hláška (šeptání) -->
  <div id="vafiStatus" aria-live="polite"></div>

  <!-- Pořadí je důležité -->
  <script type="module" src="./vaf.js?v=11"></script>
  <script type="module" src="./flow.js?v=11"></script>

  <!-- NOVÉ: Vafi engine -->
  <!-- NOVÉ: engine -->
<script type="module" src="./vafi.engine.js?v=4"></script>

<!-- Tvoje vrstvy (ponech) -->
<script type="module" src="./vafi.js?v=11"></script>
<script type="module" src="./vafi.engine.js?v=5"></script>
<script type="module" src="./world.fx.js?v=1"></script>    <!-- svět -->
<script type="module" src="./avatar.vafi.js?v=1"></script> <!-- tělo -->
<script type="module">
  import { initVoice, say } from './voice.io.js';
  initVoice();
  // malý pozdrav po načtení
  setTimeout(()=>say('Jsem vzhůru. Zkus mě ťuknout, nebo podržet, a já odpovím.'), 800);
</script>
<script type="module" src="./app.js?v=14"></script>
<script type="module" src="./app.js?v=13"></script>
</body>
</html>